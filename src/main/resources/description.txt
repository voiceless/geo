Для реализации испоьзовал scala+spark+hive, spray для http сервера, scaldi для депенденси инжекшинс и sbt для сборки. Но т.к. до этого не работал с хайвом методы для удаления
и редактирования не получилось реализовать(не получилось создать таблицу с активированными транзакциями, но принцип должен быть таким).
Hive был использован т.к. необходима была возможность редакирования входящий файлов, если бы она была не нужно можно было спокойно обойтись обычным spark sql с текстовыми данными.
Для генерации файлов есть класс generator.GeneratorMain, который принимает на вход расположение файлов и количество юзеров в файле с метками.
Для запуска использовать sbt run + args, для сборки sbt assembly.
Улучшить можно работу spray сейчас там самый простой вариант.
Т.к. запускал все на это windows, то возникали сложности с winutils и прочими настройками.
Для рассчета дистанции между точками была использована формула гаверсинусов.
Все запросы должны работать за линейное время.